<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>강내면 편의시설 지도</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Malgun Gothic', sans-serif; background: #f0f2f5; }
    .container { display: flex; flex-wrap: wrap; height: 100vh; }
    .sidebar { width: 300px; background: #fff; padding: 20px; overflow-y: auto; border-right: 2px solid #ddd; }
    .legend h3, .facility-list h3 { margin-bottom: 10px; font-size: 1.1em; color: #333; border-bottom: 2px solid #2196F3; padding-bottom: 5px; }
    .legend-item, .facility-item { padding: 8px; margin-bottom: 10px; border-radius: 6px; cursor: pointer; transition: 0.2s; }
    .legend-item:hover, .facility-item:hover { background: #e3f2fd; transform: translateX(5px); }
    .legend-item.active { background: #cce4ff; }
    .legend-icon { width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px; font-size: 16px; flex-shrink: 0; }
    .facility-name { font-weight: bold; }
    .facility-address { font-size: 0.85em; color: #666; }
    .map-container { flex: 1; min-width: 600px; height: 100%; }
    #map { width: 100%; height: 100%; }
    @media (max-width: 968px) {
        .container { flex-direction: column; }
        .sidebar { width: 100%; border-right: none; border-bottom: 2px solid #ddd; max-height: 250px; }
        .map-container { min-width: 100%; height: calc(100vh - 250px); }
    }
</style>
</head>
<body>
<div class="container">
    <div class="sidebar">
        <div class="legend">
            <h3>📍 시설 분류</h3>
            <div class="legend-item" data-category="교육기관">
                <div class="legend-icon" style="background: #4CAF50; color: white;">🎓</div>
                <span>교육기관</span>
            </div>
            <div class="legend-item" data-category="공공시설">
                <div class="legend-icon" style="background: #2196F3; color: white;">🏛️</div>
                <span>공공시설</span>
            </div>
            <div class="legend-item" data-category="편의시설">
                <div class="legend-icon" style="background: #FF9800; color: white;">🏪</div>
                <span>편의시설</span>
            </div>
            <div class="legend-item" data-category="문화시설">
                <div class="legend-icon" style="background: #9C27B0; color: white;">🎨</div>
                <span>문화시설</span>
            </div>
        </div>
        <div class="facility-list">
            <h3>📋 주요 시설 목록</h3>
            <div id="facilityListContainer"></div>
        </div>
    </div>
    <div class="map-container">
        <div id="map"></div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script>
const facilities = [
    { name: '한국교원대학교', lat: 36.61097782, lng: 127.35889177, category: '교육기관', icon:'🎓', color:'#4CAF50', address:'충북 청주시 흥덕구 강내면 태성탑연로 250' },
    { name: '한국교원대부설고등학교', lat: 36.61244272, lng: 127.35607111, category: '교육기관', icon:'🎓', color:'#4CAF50', address:'충북 청주시 흥덕구 강내면 태성탑연로 250' },
    { name: '충청대학교', lat: 36.62061023, lng: 127.36756922, category: '교육기관', icon:'🎓', color:'#4CAF50', address:'충북 청주시 흥덕구 강내면 월곡길 38' },
    { name: '월곡초등학교', lat: 36.62239358, lng: 127.36285240, category: '교육기관', icon:'🎓', color:'#4CAF50', address:'충북 청주시 흥덕구 강내면 가로수로 562' },
    { name: '미호중학교', lat: 36.62357137, lng: 127.36678761, category: '교육기관', icon:'🎓', color:'#4CAF50', address:'충북 청주시 흥덕구 강내면 가로수로 602' },
    { name: '흥덕구청', lat: 36.62895670, lng: 127.3758949, category: '공공시설', icon:'🏛️', color:'#2196F3', address:'충북 청주시 흥덕구 강내면 청주역로 71' },
    { name: '강내면사무소', lat: 36.62114828, lng: 127.35759727, category: '공공시설', icon:'🏛️', color:'#2196F3', address:'충북 청주시 흥덕구 강내면 탑연리' },
    { name: '강내파출소', lat: 36.62389408, lng: 127.36283661, category: '공공시설', icon:'🏛️', color:'#2196F3', address:'충북 청주시 흥덕구 강내면 탑연리158-2' },
    { name: '강내 도서관', lat: 36.62391188, lng: 127.36311147, category: '공공시설', icon:'🏛️', color:'#2196F3', address:'충북 청주시 흥덕구 강내면 가로수로 568' },
    { name: '강내 혜성의원', lat: 36.62318080, lng: 127.35843105, category: '공공시설', icon:'🏛️', color:'#2196F3', address:'충북 청주시 흥덕구 강내면 탑연리441-1' },
    { name: '디저트 39', lat: 36.61737934, lng: 127.35592081, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 탑연리339' },
    { name: '한국잠사박물관', lat: 36.63844223, lng: 127.38292033, category: '문화시설', icon:'🎨', color:'#9C27B0', address:'충북 청주시 흥덕구 강내면 청주역로 213-52' },
    { name: '롯데리아 강내점', lat: 36.62280188, lng: 127.35845473, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 태성탑연로 451' },
    { name: 'Cu 한국교원대점', lat: 36.60711275, lng: 127.35364584, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 태성탑연로 256' },
    { name: 'May 49-10', lat: 36.60822437, lng: 127.35540406, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 월탄3길 26-2' },
    { name: 'Cu 뉴교원대원룸점', lat: 36.60964526, lng: 127.35570476, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 월탄3길 40-1' },
    { name: '만리장성', lat: 36.61727091, lng: 127.35594454, category: '편의시설', icon:'🏪', color:'#FF9800', address:'충북 청주시 흥덕구 강내면 태성탑연로 338' }
];

const map = L.map('map').setView([36.614, 127.365], 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'© OpenStreetMap', maxZoom:18 }).addTo(map);

const markers = [];
facilities.forEach(fac => {
    const icon = L.divIcon({
        html:`<div style="background:${fac.color}; color:white; width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:20px;">${fac.icon}</div>`,
        className:'',
        iconSize:[40,40],
        iconAnchor:[20,20],
        popupAnchor:[0,-20]
    });
    const marker = L.marker([fac.lat, fac.lng], {icon:icon}).addTo(map)
        .bindPopup(`<b>${fac.name}</b><br>${fac.category}<br>📍 ${fac.address}`);
    markers.push({marker, fac});
});

function updateFacilityList(category=null){
    const container = document.getElementById('facilityListContainer');
    const filtered = category ? facilities.filter(f=>f.category===category) : facilities;
    container.innerHTML = filtered.map(f=>`
        <div class="facility-item" data-lat="${f.lat}" data-lng="${f.lng}">
            <div class="facility-name">${f.icon} ${f.name}</div>
            <div class="facility-address">${f.address}</div>
        </div>
    `).join('');
    document.querySelectorAll('.facility-item').forEach(item=>{
        item.addEventListener('click', function(){
            const lat=parseFloat(this.dataset.lat);
            const lng=parseFloat(this.dataset.lng);
            map.setView([lat,lng],16);
            markers.forEach(({marker,fac})=>{
                if(fac.lat===lat && fac.lng===lng) marker.openPopup();
            });
        });
    });
}

document.querySelectorAll('.legend-item').forEach(item=>{
    item.addEventListener('click', function(){
        const category = this.dataset.category;
        const isActive = this.classList.contains('active');
        document.querySelectorAll('.legend-item').forEach(i=>i.classList.remove('active'));
        if(!isActive){
            this.classList.add('active');
            updateFacilityList(category);
            const bounds = L.latLngBounds(facilities.filter(f=>f.category===category).map(f=>[f.lat,f.lng]));
            map.fitBounds(bounds,{padding:[50,50]});
        } else {
            updateFacilityList();
            map.setView([36.614,127.365],13);
        }
    });
});

updateFacilityList();
</script>
</body>
</html>
